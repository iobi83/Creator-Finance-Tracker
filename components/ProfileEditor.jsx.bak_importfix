import { useEffect, useState } from 'react'; import supabase from '../lib/supabaseClient';
export default function ProfileEditor(){ const [u,setU]=useState(null),[form,setForm]=useState({username:'',full_name:''}),[saving,setSaving]=useState(false),[msg,setMsg]=useState(''); useEffect(()=>{(async()=>{const {data:{user}}=await supabase.auth.getUser(); if(!user){setMsg('Please log in.');return;} setU(user); const {data,error}=await supabase.from('profiles').select('username,full_name').eq('id',user.id).single(); if(!error&&data){setForm({username:data.username||'',full_name:data.full_name||''});}})()},[]); const save=async()=>{ if(!u) return; setSaving(true); const {error}=await supabase.from('profiles').update({username:form.username||null,full_name:form.full_name||null}).eq('id',u.id); setMsg(error?('Save failed: '+error.message):'Saved'); setSaving(false); }; return (<div style={{padding:'1rem',border:'1px solid #e5e7eb',borderRadius:12,marginBottom:'1rem'}}><h3 style={{margin:'0 0 .5rem 0'}}>Profile</h3><div><label>Username<br/><input value={form.username} onChange={e=>setForm(f=>({...f,username:e.target.value}))} placeholder="your-handle" /></label></div><div style={{marginTop:8}}><label>Full name<br/><input value={form.full_name} onChange={e=>setForm(f=>({...f,full_name:e.target.value}))} placeholder="Your Name" /></label></div><button disabled={saving} onClick={save} style={{marginTop:10}}>{saving?'Savingâ€¦':'Save'}</button><div style={{marginTop:8,fontSize:12,opacity:.7}}>{msg}</div></div>); }
